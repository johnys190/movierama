(this["webpackJsonpmovierama-client"]=this["webpackJsonpmovierama-client"]||[]).push([[0],{138:function(e,t,a){e.exports=a(282)},143:function(e,t,a){},144:function(e,t,a){},145:function(e,t,a){},172:function(e,t,a){},183:function(e,t,a){},266:function(e,t,a){},267:function(e,t,a){},268:function(e,t,a){},269:function(e,t,a){},270:function(e,t,a){},275:function(e,t,a){},282:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(9),i=a.n(s),o=(a(143),a(21)),l=a(22),c=a(7),u=a(24),m=a(23),d=(a(144),a(20)),h="http://localhost:8080/movierama",v=function(e){var t=new Headers({"Content-Type":"application/json"});localStorage.getItem("accessToken")&&t.append("Authorization","Bearer "+localStorage.getItem("accessToken"));var a={headers:t};return e=Object.assign({},a,e),fetch(e.url,e).then((function(e){return e.json().then((function(t){return e.ok?t:Promise.reject(t)}))}))};function p(e,t){return v({url:h+"/movies?page="+(e=e||0)+"&size="+(t=t||5),method:"GET"})}function g(e,t){return v({url:h+"/movies/ordered/like?page="+(e=e||0)+"&size="+(t=t||5),method:"GET"})}function f(e,t){return v({url:h+"/movies/ordered/hate?page="+(e=e||0)+"&size="+(t=t||5),method:"GET"})}function b(e,t,a){return v({url:h+"/users/"+e+"/movies?page="+(t=t||0)+"&size="+(a=a||5),method:"GET"})}function E(e,t,a){return v({url:h+"/users/"+e+"/movies/opinions?page="+(t=t||0)+"&size="+(a=a||5),method:"GET"})}a(145);var y=a(284),O=a(16),S=a(293),k=a(294),M=["#F44336","#e91e63","#9c27b0","#673ab7","#ff9800","#ff5722","#795548","#607d8b","#3f51b5","#2196F3","#00bcd4","#009688","#2196F3","#32c787","#00BCD4","#ff5652","#ffc107","#ff85af","#FF9800","#39bbb0","#4CAF50","#ffeb3b","#ffc107"];function N(e){e=e.substr(0,6);for(var t=0,a=0;a<e.length;a++)t=31*t+e.charCodeAt(a);var n=Math.abs(t%M.length);return M[n]}var j=a(283),L=a(50),C=j.default.Group,w=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).isSelected=function(t){return e.props.movie.selectedChoice===t},e}return Object(l.a)(a,[{key:"render",value:function(){var e=!0;return this.props.currentUsername&&(e=this.props.currentUsername===this.props.movie.createdBy.username),r.a.createElement("div",{className:"movie-content"},r.a.createElement("div",{className:"movie-header"},r.a.createElement("div",{className:"movie-creator-info"},r.a.createElement(O.b,{className:"creator-link",to:"/users/".concat(this.props.movie.createdBy.username)},r.a.createElement(y.a,{className:"movie-creator-avatar",style:{backgroundColor:N(this.props.movie.createdBy.username)}},this.props.movie.createdBy.name[0].toUpperCase()),r.a.createElement("span",{className:"movie-creator-username"},"Posted by: @",this.props.movie.createdBy.username),r.a.createElement("span",{className:"movie-creation-date"},"Created at: ",function(e){var t=new Date(e),a=t.getMonth(),n=t.getFullYear(),r=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes();return t.getDate()+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a]+" "+n+" - "+t.getHours()+":"+r+":"+t.getSeconds()}(this.props.movie.creationDateTime)))),r.a.createElement("div",{className:"movie-question"},this.props.movie.title),r.a.createElement("div",{className:"movie-question"},this.props.movie.description)),r.a.createElement("div",{className:"movie-choices"},e?null:r.a.createElement(C,{className:"movie-choice-radio-group",onChange:this.props.handleVoteChange,value:this.props.currentVote},r.a.createElement(j.default,{className:"movie-choice-radio",key:"radio.likeId",value:"LIKE"},"Like"),r.a.createElement(j.default,{className:"movie-choice-radio",key:"radio.hateId",value:"HATE"},"Hate"))),r.a.createElement("div",{className:"movie-footer"},e?null:r.a.createElement(L.a,{className:"vote-button",disabled:!this.props.currentVote,onClick:this.props.handleVoteSubmit},"Vote"),r.a.createElement("span",{className:"total-votes"},this.props.movie.totalLikes," ",r.a.createElement(S.a,null)),r.a.createElement("span",{className:"separator"}),r.a.createElement("span",{className:"total-votes"},this.props.movie.totalhates," ",r.a.createElement(k.a,null)),this.props.movie.selectedChoice?r.a.createElement("span",{className:"separator"},"| You have voted ","".concat(this.props.movie.selectedChoice),"."):r.a.createElement("span",{className:"separator"}),this.props.movie.selectedChoice?r.a.createElement(L.a,{className:"clear-button",disabled:!this.props.movie.selectedChoice,onClick:this.props.handleClearVote},"Clear"):null))}}]),a}(n.Component),U=a(285);function P(e){return r.a.createElement(U.a,{tip:"Loading..."})}var T=a(289),A=a(295),I=a(296),D=(a(172),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={movies:[],page:0,size:10,totalElements:0,totalPages:0,last:!0,currentVotes:[],isLoading:!1,order:"date"},n.loadMovieList=n.loadMovieList.bind(Object(c.a)(n)),n.handleLoadMore=n.handleLoadMore.bind(Object(c.a)(n)),n.handleLikeOrdering=n.handleLikeOrdering.bind(Object(c.a)(n)),n.handleHateOrdering=n.handleHateOrdering.bind(Object(c.a)(n)),n.handleDateOrdering=n.handleDateOrdering.bind(Object(c.a)(n)),n.refreshTheOrder=n.refreshTheOrder.bind(Object(c.a)(n)),n}return Object(l.a)(a,[{key:"loadMovieList",value:function(){var e,t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;this.props.username?"USER_CREATED_MOVIES"===this.props.type?e=b(this.props.username,a,n):"USER_OPINIONS"===this.props.type&&(e=E(this.props.username,a,n)):e=p(a,n),e&&(this.setState({isLoading:!0}),e.then((function(e){var n=t.state.movies.slice(),r=t.state.currentVotes.slice();t.setState({movies:0===a?e.content:n.concat(e.content),page:e.page,size:e.size,totalElements:e.totalElements,totalPages:e.totalPages,last:e.last,currentVotes:r.concat(Array(e.content.length).fill(null)),isLoading:!1,order:"date"})})).catch((function(e){t.setState({isLoading:!1})})))}},{key:"componentDidMount",value:function(){this.loadMovieList()}},{key:"componentDidUpdate",value:function(e){this.props.isAuthenticated!==e.isAuthenticated&&(this.setState({movies:[],page:0,size:10,totalElements:0,totalPages:0,last:!0,currentVotes:[],isLoading:!1,order:"date"}),this.loadMovieList())}},{key:"handleLoadMore",value:function(){"date"===this.state.order?this.loadMovieList(this.state.page+1):"like"===this.state.order?this.loadLikeOrdering(this.state.page+1):"hate"===this.state.order&&this.loadHateOrdering(this.state.page+1)}},{key:"refreshTheOrder",value:function(){"date"===this.state.order?this.loadMovieList():"like"===this.state.order?this.loadLikeOrdering():"hate"===this.state.order&&this.loadHateOrdering()}},{key:"handleVoteChange",value:function(e,t){var a=this.state.currentVotes.slice();a[t]=e.target.value,this.setState({currentVotes:a})}},{key:"handleVoteSubmit",value:function(e,t){var a=this;if(e.preventDefault(),!this.props.isAuthenticated)return this.props.history.push("/login"),void T.a.info({message:"Movierama",description:"Please login to put an opinion."});var n=this.state.movies[t],r=this.state.currentVotes[t];(function(e){var t={opinionText:e.opinion};return v({url:h+"/movies/"+e.movieId+"/opinion",method:"POST",body:JSON.stringify(t)})})({movieId:n.id,opinion:r}).then((function(e){var n=a.state.movies.slice();n[t]=e,a.setState({movies:n,currentVotes:Array(n.length).fill(null)}),a.refreshTheOrder()})).catch((function(e){401===e.status?a.props.handleLogout("/login","error","You have been logged out. Please login to vote"):T.a.error({message:"Movierama",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"handleClearVote",value:function(e,t){var a=this;if(e.preventDefault(),!this.props.isAuthenticated)return this.props.history.push("/login"),void T.a.info({message:"Movierama",description:"Please login to put an opinion."});var n,r=this.state.movies[t];this.props.isProfileMovieList&&this.props.handleTotalMovieOpinions(this.props.currentUser.username),(n=r.id,v({url:h+"/movies/"+n+"/opinion/clear",method:"POST"})).then((function(e){var n=a.state.movies.slice();n[t]=e,console.log(a.props.isProfileMovieList),console.log(n[t].createdBy.username),console.log(a.props),console.log(a.state),!a.props.isProfileMovieList||n[t].createdBy.username!==a.props.currentUser.username&&a.props.currentUser.username!==a.props.username||n.splice(t,1),a.setState({movies:n,currentVotes:Array(n.length).fill(null)})})).catch((function(e){401===e.status?a.props.handleLogout("/login","error","You have been logged out. Please login to vote"):T.a.error({message:"Movierama",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"handleLikeOrdering",value:function(){this.loadLikeOrdering()}},{key:"loadLikeOrdering",value:function(){var e,t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;(e=g(a,n))&&(this.setState({isLoading:!0}),e.then((function(e){var n=t.state.movies.slice(),r=t.state.currentVotes.slice();t.setState({movies:0===a?e.content:n.concat(e.content),page:e.page,size:e.size,totalElements:e.totalElements,totalPages:e.totalPages,last:e.last,currentVotes:r.concat(Array(e.content.length).fill(null)),isLoading:!1,order:"like"})})).catch((function(e){t.setState({isLoading:!1})})))}},{key:"handleHateOrdering",value:function(){this.loadHateOrdering()}},{key:"loadHateOrdering",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=f(t,a);n&&(this.setState({isLoading:!0}),n.then((function(a){var n=e.state.movies.slice(),r=e.state.currentVotes.slice();e.setState({movies:0===t?a.content:n.concat(a.content),page:a.page,size:a.size,totalElements:a.totalElements,totalPages:a.totalPages,last:a.last,currentVotes:r.concat(Array(a.content.length).fill(null)),isLoading:!1,order:"hate"})})).catch((function(t){e.setState({isLoading:!1})})))}},{key:"handleDateOrdering",value:function(){this.loadMovieList()}},{key:"render",value:function(){var e=this,t=[];this.state.movies.forEach((function(a,n){t.push(r.a.createElement(w,{key:a.id,movie:a,currentVote:e.state.currentVotes[n],currentUsername:e.props.currentUser?e.props.currentUser.username:null,handleVoteChange:function(t){return e.handleVoteChange(t,n)},handleClearVote:function(t){return e.handleClearVote(t,n)},handleVoteSubmit:function(t){return e.handleVoteSubmit(t,n)}}))}));var a=[];if(!this.props.isProfileMovieList){var n=r.a.createElement(L.a,{key:"likeOrderButtonKey",onClick:this.handleLikeOrdering,disabled:this.state.isLoading},"Order by likes",r.a.createElement(S.a,null)),s=r.a.createElement(L.a,{key:"hateOrderButtonKey",onClick:this.handleHateOrdering,disabled:this.state.isLoading},"Order by hates",r.a.createElement(k.a,null)),i=r.a.createElement(L.a,{key:"dateOrderButtonKey",onClick:this.handleDateOrdering,disabled:this.state.isLoading},"Order by Date",r.a.createElement(A.a,null));a.push(n),a.push(s),a.push(i)}return r.a.createElement("div",{className:"movies-container"},a,t,this.state.isLoading||0!==this.state.movies.length?null:r.a.createElement("div",{className:"no-movies-found"},r.a.createElement("span",null,"No Movies Found.")),this.state.isLoading||this.state.last?null:r.a.createElement("div",{className:"load-more-movies"},r.a.createElement(L.a,{type:"dashed",onClick:this.handleLoadMore,disabled:this.state.isLoading},r.a.createElement(I.a,null)," Load more")),this.state.isLoading?r.a.createElement(P,null):null)}}]),a}(n.Component)),V=Object(d.g)(D),z=a(42),x=(a(183),a(287)),F=a(291),B=x.a.Item,H=F.a.TextArea,R=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).validateDescription=function(e){return 0===e.length?{validateStatus:"error",errorMsg:"Please enter a description"}:e.length>400?{validateStatus:"error",errorMsg:"Description is too long. Only ".concat(400," characters allowed!")}:{validateStatus:"success",errorMsg:null}},n.validateTitle=function(e){return 0===e.length?{validateStatus:"error",errorMsg:"Please enter a title"}:e.length>400?{validateStatus:"error",errorMsg:"Title is too long. Only ".concat(100," characters allowed!")}:{validateStatus:"success",errorMsg:null}},n.state={description:{text:""},title:{text:""}},n.handleSubmit=n.handleSubmit.bind(Object(c.a)(n)),n.handleDescriptionChange=n.handleDescriptionChange.bind(Object(c.a)(n)),n.handleTitleChange=n.handleTitleChange.bind(Object(c.a)(n)),n.isFormInvalid=n.isFormInvalid.bind(Object(c.a)(n)),n}return Object(l.a)(a,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a={description:this.state.description.text,title:this.state.title.text};(function(e,t){return v({url:h+"/users/"+e+"/movies",method:"POST",body:JSON.stringify(t)})})(this.props.currentUser.username,a).then((function(e){T.a.success({message:"Movierama",description:"You successfully add a new movie."}),t.props.history.push("/")})).catch((function(e){401===e.status?t.props.handleLogout("/login","error","You have been logged out. Please login create movie."):T.a.error({message:"Movierama",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"handleDescriptionChange",value:function(e){var t=e.target.value;this.setState({description:Object(z.a)({text:t},this.validateDescription(t))})}},{key:"handleTitleChange",value:function(e){var t=e.target.value;this.setState({title:Object(z.a)({text:t},this.validateTitle(t))})}},{key:"isFormInvalid",value:function(){return"success"!==this.state.description.validateStatus||("success"!==this.state.title.validateStatus||void 0)}},{key:"render",value:function(){return r.a.createElement("div",{className:"new-movie-container"},r.a.createElement("h1",{className:"page-title"},"Add a new Movie"),r.a.createElement("div",{className:"new-movie-content"},r.a.createElement(x.a,{onSubmit:this.handleSubmit,className:"create-movie-form"},r.a.createElement(B,{validateStatus:this.state.title.validateStatus,help:this.state.title.errorMsg,className:"movie-form-row"},r.a.createElement(H,{placeholder:"Enter your title",style:{fontSize:"16px"},autosize:{minRows:1,maxRows:2},name:"title",value:this.state.title.text,onChange:this.handleTitleChange})),r.a.createElement(B,{validateStatus:this.state.description.validateStatus,help:this.state.description.errorMsg,className:"movie-form-row"},r.a.createElement(H,{placeholder:"Enter your description",style:{fontSize:"16px"},autosize:{minRows:4,maxRows:8},name:"description",value:this.state.description.text,onChange:this.handleDescriptionChange})),r.a.createElement(B,{className:"movie-form-row"},r.a.createElement(L.a,{type:"primary",htmlType:"submit",size:"large",disabled:this.isFormInvalid(),className:"create-movie-form-button"},"Create Movie")))))}}]),a}(n.Component),G=(a(266),a(297)),Y=a(298),J=x.a.Item,K=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=x.a.create()(_);return r.a.createElement("div",{className:"login-container"},r.a.createElement("h1",{className:"page-title"},"Login"),r.a.createElement("div",{className:"login-content"},r.a.createElement(e,{onLogin:this.props.onLogin})))}}]),a}(n.Component),_=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleSubmit=n.handleSubmit.bind(Object(c.a)(n)),n}return Object(l.a)(a,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields((function(e,a){e||function(e){return v({url:h+"/auth/signin",method:"POST",body:JSON.stringify(e)})}(Object.assign({},a)).then((function(e){localStorage.setItem("accessToken",e.accessToken),t.props.onLogin()})).catch((function(e){401===e.status?T.a.error({message:"Movierama",description:"Your Username or Password is incorrect. Please try again!"}):T.a.error({message:"Movierama",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(x.a,{onSubmit:this.handleSubmit,className:"login-form"},r.a.createElement(J,null,e("usernameOrEmail",{rules:[{required:!0,message:"Please input your email or username!"}]})(r.a.createElement(F.a,{prefix:r.a.createElement(G.a,null),size:"large",name:"usernameOrEmail",placeholder:"Email or username"}))),r.a.createElement(J,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(r.a.createElement(F.a,{prefix:r.a.createElement(Y.a,null),size:"large",name:"password",type:"password",placeholder:"Password"}))),r.a.createElement(J,null,r.a.createElement(L.a,{type:"primary",htmlType:"submit",size:"large",className:"login-form-button"},"Login"),"Or ",r.a.createElement(O.b,{to:"/signup"},"Register now!")))}}]),a}(n.Component),q=K,W=a(78),$=(a(267),x.a.Item),Q=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).validateName=function(e){return e.length<4?{validateStatus:"error",errorMsg:"Name is too short (Minimum ".concat(4," characters needed.)")}:e.length>40?{validationStatus:"error",errorMsg:"Name is too long (Maximum ".concat(40," characters allowed.)")}:{validateStatus:"success",errorMsg:null}},n.validateEmail=function(e){return e?RegExp("[^@ ]+@[^@ ]+\\.[^@ ]+").test(e)?e.length>40?{validateStatus:"error",errorMsg:"Email is too long (Maximum ".concat(40," characters allowed)")}:{validateStatus:null,errorMsg:null}:{validateStatus:"error",errorMsg:"Email not valid"}:{validateStatus:"error",errorMsg:"Email may not be empty"}},n.validateUsername=function(e){return e.length<3?{validateStatus:"error",errorMsg:"Username is too short (Minimum ".concat(3," characters needed.)")}:e.length>15?{validationStatus:"error",errorMsg:"Username is too long (Maximum ".concat(15," characters allowed.)")}:{validateStatus:null,errorMsg:null}},n.validatePassword=function(e){return e.length<6?{validateStatus:"error",errorMsg:"Password is too short (Minimum ".concat(6," characters needed.)")}:e.length>20?{validationStatus:"error",errorMsg:"Password is too long (Maximum ".concat(20," characters allowed.)")}:{validateStatus:"success",errorMsg:null}},n.state={name:{value:""},username:{value:""},email:{value:""},password:{value:""}},n.handleInputChange=n.handleInputChange.bind(Object(c.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(c.a)(n)),n.validateUsernameAvailability=n.validateUsernameAvailability.bind(Object(c.a)(n)),n.validateEmailAvailability=n.validateEmailAvailability.bind(Object(c.a)(n)),n.isFormInvalid=n.isFormInvalid.bind(Object(c.a)(n)),n}return Object(l.a)(a,[{key:"handleInputChange",value:function(e,t){var a=e.target,n=a.name,r=a.value;this.setState(Object(W.a)({},n,Object(z.a)({value:r},t(r))))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),function(e){return v({url:h+"/auth/signup",method:"POST",body:JSON.stringify(e)})}({name:this.state.name.value,email:this.state.email.value,username:this.state.username.value,password:this.state.password.value}).then((function(e){T.a.success({message:"Movierama",description:"You're successfully registered. Please Login to continue!"}),t.props.history.push("/login")})).catch((function(e){T.a.error({message:"Movierama",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"isFormInvalid",value:function(){return!("success"===this.state.name.validateStatus&&"success"===this.state.username.validateStatus&&"success"===this.state.email.validateStatus&&"success"===this.state.password.validateStatus)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"signup-container"},r.a.createElement("h1",{className:"page-title"},"Sign Up"),r.a.createElement("div",{className:"signup-content"},r.a.createElement(x.a,{onSubmit:this.handleSubmit,className:"signup-form"},r.a.createElement($,{label:"Full Name",validateStatus:this.state.name.validateStatus,help:this.state.name.errorMsg},r.a.createElement(F.a,{size:"large",name:"name",autoComplete:"off",placeholder:"Your full name",value:this.state.name.value,onChange:function(t){return e.handleInputChange(t,e.validateName)}})),r.a.createElement($,{label:"Username",hasFeedback:!0,validateStatus:this.state.username.validateStatus,help:this.state.username.errorMsg},r.a.createElement(F.a,{size:"large",name:"username",autoComplete:"off",placeholder:"A unique username",value:this.state.username.value,onBlur:this.validateUsernameAvailability,onChange:function(t){return e.handleInputChange(t,e.validateUsername)}})),r.a.createElement($,{label:"Email",hasFeedback:!0,validateStatus:this.state.email.validateStatus,help:this.state.email.errorMsg},r.a.createElement(F.a,{size:"large",name:"email",type:"email",autoComplete:"off",placeholder:"Your email",value:this.state.email.value,onBlur:this.validateEmailAvailability,onChange:function(t){return e.handleInputChange(t,e.validateEmail)}})),r.a.createElement($,{label:"Password",validateStatus:this.state.password.validateStatus,help:this.state.password.errorMsg},r.a.createElement(F.a,{size:"large",name:"password",type:"password",autoComplete:"off",placeholder:"A password between 6 to 20 characters",value:this.state.password.value,onChange:function(t){return e.handleInputChange(t,e.validatePassword)}})),r.a.createElement($,null,r.a.createElement(L.a,{type:"primary",htmlType:"submit",size:"large",className:"signup-form-button",disabled:this.isFormInvalid()},"Sign up"),"Already registed? ",r.a.createElement(O.b,{to:"/login"},"Login now!")))))}},{key:"validateUsernameAvailability",value:function(){var e,t=this,a=this.state.username.value,n=this.validateUsername(a);"error"!==n.validateStatus?(this.setState({username:{value:a,validateStatus:"validating",errorMsg:null}}),(e=a,v({url:h+"/users/checkUsernameAvailability?username="+e,method:"GET"})).then((function(e){e.available?t.setState({username:{value:a,validateStatus:"success",errorMsg:null}}):t.setState({username:{value:a,validateStatus:"error",errorMsg:"This username is already taken"}})})).catch((function(e){t.setState({username:{value:a,validateStatus:"success",errorMsg:null}})}))):this.setState({username:Object(z.a)({value:a},n)})}},{key:"validateEmailAvailability",value:function(){var e,t=this,a=this.state.email.value,n=this.validateEmail(a);"error"!==n.validateStatus?(this.setState({email:{value:a,validateStatus:"validating",errorMsg:null}}),(e=a,v({url:h+"/users/checkEmailAvailability?email="+e,method:"GET"})).then((function(e){e.available?t.setState({email:{value:a,validateStatus:"success",errorMsg:null}}):t.setState({email:{value:a,validateStatus:"error",errorMsg:"This Email is already registered"}})})).catch((function(e){t.setState({email:{value:a,validateStatus:"success",errorMsg:null}})}))):this.setState({email:Object(z.a)({value:a},n)})}}]),a}(n.Component),X=a(288),Z=(a(268),a(269),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"page-not-found"},r.a.createElement("h1",{className:"title"},400),r.a.createElement("div",{className:"desc"},"The Page you are looking for was not found"),r.a.createElement(O.b,{to:"/"},r.a.createElement(L.a,{className:"go-back-btn",type:"primary",size:"large"},"Go Back")))}}]),a}(n.Component)),ee=(a(270),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"server-error-page"},r.a.createElement("h1",{className:"server-error-title"},500),r.a.createElement("div",{className:"server-error-desc"},"Oops! Something went wrong at our Server."),r.a.createElement(O.b,{to:"/"},r.a.createElement(L.a,{className:"server-error-go-back-btn",type:"primary",size:"large"},"Go Back")))}}]),a}(n.Component)),te=X.a.TabPane,ae=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleTotalMovieOpinions=function(e){if(e===n.state.user.name){var t=Object(z.a)({},n.state.user);t.totalMovieOpinions=t.totalMovieOpinions-1,n.setState({user:t})}},n.state={user:null,isLoading:!1},n.loadUserProfile=n.loadUserProfile.bind(Object(c.a)(n)),n.handleTotalMovieOpinions=n.handleTotalMovieOpinions.bind(Object(c.a)(n)),n}return Object(l.a)(a,[{key:"loadUserProfile",value:function(e){var t=this;this.setState({isLoading:!0}),function(e){return v({url:h+"/users/"+e,method:"GET"})}(e).then((function(e){t.setState({user:e,isLoading:!1})})).catch((function(e){404===e.status?t.setState({notFound:!0,isLoading:!1}):401===e.status?(t.props.history.push("/login"),T.a.info({message:"Movierama",description:"Please login to see the details"})):t.setState({serverError:!0,isLoading:!1})}))}},{key:"componentDidMount",value:function(){var e=this.props.match.params.username;this.loadUserProfile(e)}},{key:"componentDidUpdate",value:function(e){this.props.match.params.username!==e.match.params.username&&(console.log("componentDidupdate laod nextProps.match.params.username"),this.loadUserProfile(this.props.match.params.username))}},{key:"render",value:function(){if(this.state.isLoading)return r.a.createElement(P,null);if(this.state.notFound)return r.a.createElement(Z,null);if(this.state.serverError)return r.a.createElement(ee,null);return r.a.createElement("div",{className:"profile"},this.state.user?r.a.createElement("div",{className:"user-profile"},r.a.createElement("div",{className:"user-details"},r.a.createElement("div",{className:"user-avatar"},r.a.createElement(y.a,{className:"user-avatar-circle",style:{backgroundColor:N(this.state.user.name)}},this.state.user.name[0].toUpperCase())),r.a.createElement("div",{className:"user-summary"},r.a.createElement("div",{className:"full-name"},this.state.user.name),r.a.createElement("div",{className:"username"},"@",this.state.user.username))),r.a.createElement("div",{className:"user-movie-details"},r.a.createElement(X.a,{defaultActiveKey:"1",animated:!1,tabBarStyle:{textAlign:"center"},size:"large",className:"profile-tabs"},r.a.createElement(te,{tab:"".concat(this.state.user.totalCreatedMovies,"  Movies"),key:"1"},r.a.createElement(V,{isAuthenticated:this.props.isAuthenticated,currentUser:this.props.currentUser,username:this.props.match.params.username,type:"USER_CREATED_MOVIES",isProfileMovieList:!0,handleTotalMovieOpinions:this.handleTotalMovieOpinions})),r.a.createElement(te,{tab:"".concat(this.state.user.totalMovieOpinions," Opinions"),key:"2"},r.a.createElement(V,{isAuthenticated:this.props.isAuthenticated,currentUser:this.props.currentUser,username:this.props.match.params.username,type:"USER_OPINIONS",isProfileMovieList:!0,handleTotalMovieOpinions:this.handleTotalMovieOpinions}))))):null)}}]),a}(n.Component),ne=Object(d.g)(ae),re=(a(275),a(286)),se=a(290),ie=a(292),oe=a(299),le=a(300),ce=a(301),ue=re.a.Header,me=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleMenuClick=n.handleMenuClick.bind(Object(c.a)(n)),n}return Object(l.a)(a,[{key:"handleMenuClick",value:function(e){"logout"===e.key&&this.props.onLogout()}},{key:"render",value:function(){var e;return e=this.props.currentUser?[r.a.createElement(se.a.Item,{key:"/movies/new"},r.a.createElement(O.b,{to:"/movies/new"},r.a.createElement(oe.a,{className:"nav-icon"}))),r.a.createElement(se.a.Item,{key:"/"},r.a.createElement(O.b,{to:"/"},r.a.createElement(le.a,{className:"nav-icon"}))),r.a.createElement(se.a.Item,{key:"/profile",className:"profile-menu"},r.a.createElement(de,{currentUser:this.props.currentUser,handleMenuClick:this.handleMenuClick}))]:[r.a.createElement(se.a.Item,{key:"/login"},r.a.createElement(O.b,{to:"/login"},"Login")),r.a.createElement(se.a.Item,{key:"/signup"},r.a.createElement(O.b,{to:"/signup"},"Signup"))],r.a.createElement(ue,{className:"app-header"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"app-title"},r.a.createElement(O.b,{to:"/"},"Movierama")),r.a.createElement(se.a,{className:"app-menu",mode:"horizontal",selectedKeys:[this.props.location.pathname],style:{lineHeight:"64px"}},e)))}}]),a}(n.Component);function de(e){var t=r.a.createElement(se.a,{onClick:e.handleMenuClick,className:"profile-dropdown-menu"},r.a.createElement(se.a.Item,{key:"user-info",className:"dropdown-item",disabled:!0},r.a.createElement("div",{className:"user-full-name-info"},e.currentUser.name),r.a.createElement("div",{className:"username-info"},"@",e.currentUser.username)),r.a.createElement(se.a.Divider,null),r.a.createElement(se.a.Item,{key:"profile",className:"dropdown-item"},r.a.createElement(O.b,{to:"/users/".concat(e.currentUser.username)},"Profile")),r.a.createElement(se.a.Item,{key:"logout",className:"dropdown-item"},"Logout"));return r.a.createElement(ie.a,{overlay:t,trigger:["click"],getPopupContainer:function(){return document.getElementsByClassName("profile-menu")[0]}},r.a.createElement("a",{className:"ant-dropdown-link"},r.a.createElement(G.a,{className:"nav-icon",style:{marginRight:0}})," ",r.a.createElement(ce.a,null)))}var he=Object(d.g)(me),ve=a(136),pe=function(e){var t=e.component,a=e.authenticated,n=Object(ve.a)(e,["component","authenticated"]);return r.a.createElement(d.b,Object.assign({},n,{render:function(e){return a?r.a.createElement(t,Object.assign({},n,e)):r.a.createElement(d.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},ge=re.a.Content,fe=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={currentUser:null,isAuthenticated:!1,isLoading:!1},n.handleLogout=n.handleLogout.bind(Object(c.a)(n)),n.loadCurrentUser=n.loadCurrentUser.bind(Object(c.a)(n)),n.handleLogin=n.handleLogin.bind(Object(c.a)(n)),T.a.config({placement:"topRight",top:70,duration:3}),n}return Object(l.a)(a,[{key:"loadCurrentUser",value:function(){var e=this;this.setState({isLoading:!0}),(localStorage.getItem("accessToken")?v({url:h+"/oauth2/userInfo",method:"GET"}):Promise.reject("No access token set.")).then((function(t){e.setState({currentUser:t,isAuthenticated:!0,isLoading:!1})})).catch((function(t){e.setState({isLoading:!1})}))}},{key:"componentDidMount",value:function(){this.loadCurrentUser()}},{key:"handleLogout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"You're successfully logged out.";localStorage.removeItem("accessToken"),this.setState({currentUser:null,isAuthenticated:!1}),this.props.history.push(e),T.a[t]({message:"Movierama",description:a})}},{key:"handleLogin",value:function(){T.a.success({message:"Movierama",description:"You're successfully logged in."}),this.loadCurrentUser(),this.props.history.push("/")}},{key:"render",value:function(){var e=this;return this.state.isLoading?r.a.createElement(P,null):r.a.createElement(re.a,{className:"app-container"},r.a.createElement(he,{isAuthenticated:this.state.isAuthenticated,currentUser:this.state.currentUser,onLogout:this.handleLogout}),r.a.createElement(ge,{className:"app-content"},r.a.createElement("div",{className:"container"},r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",render:function(t){return r.a.createElement(V,Object.assign({isAuthenticated:e.state.isAuthenticated,currentUser:e.state.currentUser,handleLogout:e.handleLogout,isProfileMovieList:!1},t))}}),r.a.createElement(d.b,{path:"/login",render:function(t){return r.a.createElement(q,Object.assign({onLogin:e.handleLogin},t))}}),r.a.createElement(d.b,{path:"/signup",component:Q}),r.a.createElement(d.b,{path:"/users/:username",render:function(t){return r.a.createElement(ne,Object.assign({isAuthenticated:e.state.isAuthenticated,currentUser:e.state.currentUser},t))}}),r.a.createElement(pe,{authenticated:this.state.isAuthenticated,path:"/movies/new",component:R,handleLogout:this.handleLogout,currentUser:this.state.currentUser}),r.a.createElement(d.b,{component:Z})))))}}]),a}(n.Component),be=Object(d.g)(fe);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(O.a,null,r.a.createElement(be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[138,1,2]]]);
//# sourceMappingURL=main.93eda3a7.chunk.js.map